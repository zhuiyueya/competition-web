# 比赛报名小程序｜超级详细需求文档

## 1. 术语与角色

- **学生端小程序**：参赛人员用于报名、查询获奖、查询优秀辅导员证书的端。
- **管理员端小程序**：管理员用于审核报名、导入参赛号、导入获奖/优秀辅导员信息、生成证书的端。
- **参赛号**：比赛开始后生成的**每位选手唯一参赛编号**。
- **优秀辅导员**：报名阶段填写的“指导老师”，赛后可被评为优秀辅导员并生成证书。
- **证书模板**：由甲方提供 PNG 底图 + Logo PNG + 盖章 PNG + 字体文件，用于生成 PDF 证书。
- **Excel 模板**：管理员用于批量导入信息的表格，字段需与甲方确认。

---

## 2. 项目边界

### 2.1 本项目包含
- 学生端报名、获奖查询、优秀辅导员证书查询。
- 管理员端审核、参赛号导入匹配、获奖导入、优秀辅导员导入、证书批量生成。
- PDF 证书生成与下载。

### 2.2 本项目不包含
- 实名认证（明确不需要）。
- 短信验证码（明确不需要）。
- 学校库维护（学校由用户填写）。

---

## 3. 系统入口

### 3.1 学生端入口
1. 用户扫描二维码。
2. 或进入公众号详情/私信界面。
3. 点击底部菜单“报名”进入小程序。
4. 若未授权登录，则提示微信授权登录。

### 3.2 学生端获奖/辅导员查询入口
1. 用户进入公众号。
2. 点击“获奖”组件进入获奖查询。
3. 点击“优秀辅导员”组件进入优秀辅导员证书查询。

### 3.3 管理员端入口
1. 管理员打开管理员端小程序。
2. 输入账号与密码登录。

---

## 4. 数据字段清单（学生报名）

> 所有字段均需保存到数据库，若未填写则不允许提交。

### 4.1 基础字段（必填）
1. **行政区域（市）**
   - 类型：下拉选择
   - 校验：必须选择
2. **行政区域（区/县）**
   - 类型：下拉选择（与“市”联动）
   - 校验：必须选择
3. **学校名称**
   - 类型：文本
   - 校验：不能为空；长度 2–40 字
   - 说明：与公章一致
4. **竞赛类别**
   - 类型：固定文本
   - 值：`青少年无人机大赛`
5. **参赛项目（大类）**
   - 类型：下拉选择
   - 校验：必须选择
   - 选项：编程挑战赛 / 第一视角飞行赛 / 飞行操控赛 / 空中对抗赛 / 应用场景飞行赛
6. **参赛项目（具体任务）**
   - 类型：下拉选择
   - 校验：必须选择
   - 说明：由“参赛项目（大类）”联动决定
7. **参赛学段（组别）**
   - 类型：下拉选择
   - 校验：必须选择
   - 说明：由“参赛项目（具体任务）”限定可选学段
   - 可选值：小学 / 初中 / 高中/职高（含中专）
   - 若项目适用学段标注为“中学”，系统提供“初中/高中/职高”选项
8. **选手姓名（按人数动态显示）**
   - 类型：文本（1–5 个输入框）
   - 校验：所有显示的输入框均必填；每项长度 2–20 字
   - 人数规则：
     - 单人项目：仅显示 1 个姓名输入框
     - 3 人项目：显示 3 个姓名输入框
     - 5 人项目：显示 5 个姓名输入框
   - 排序规则：第一位默认为前锋，后续成员默认为后卫（仅说明）
9. **指导老师姓名**
   - 类型：文本
   - 校验：不能为空；长度 2–20 字
10. **指导老师电话**
    - 类型：文本
    - 校验：手机号格式（11 位数字）
11. **领队姓名**
    - 类型：文本
    - 校验：不能为空；长度 2–20 字
12. **领队电话**
    - 类型：文本
    - 校验：手机号格式（11 位数字）
13. **参赛人手机号**
    - 类型：文本
    - 校验：手机号格式（11 位数字）
14. **参赛人邮箱**
    - 类型：文本
    - 校验：邮箱格式（包含 `@` 与域名）

### 4.1.1 参赛项目分类与适用学段

> 参赛项目为“两级选择”：先选大类，再选具体任务。系统据此限定参赛学段与人数。

**1. 编程挑战赛（2 个小类）**
- 无人机综合任务赛（适用学段：小学、中学）
- 编程越障任务（适用学段：小学、初中、高中/职高）

**2. 第一视角飞行赛（2 个小类）**
- 多旋翼穿越任务（适用学段：小学、初中、高中/职高）
- 无人机第一视角竞速（无刷组 A2）（适用学段：小学、初中、高中/职高）

**3. 飞行操控赛（4 个小类）**
- 个人越障任务（适用学段：小学、初中、高中/职高）
- 无人机第三视角竞速（适用学段：小学、初中、高中/职高）
- 超级进球手（200mm 空心杯）任务（适用学段：小学、中学）
- 超级进球手（200mm 无刷）（适用学段：小学、中学）

**4. 空中对抗赛（3 个小类）**
- 无人机足球任务-3v3（200mm 空心杯）（适用学段：小学、中学）
- 无人机足球任务-3v3（200mm 无刷）（适用学段：中学）
- 无人机足球任务-5v5（400mm 无刷）（适用学段：中学）

**5. 应用场景飞行赛（2 个小类）**
- 装调运输任务（适用学段：小学、初中、高中/职高）
- 空中狙击任务（适用学段：小学、初中、高中/职高）

### 4.1.2 参赛人数规则（由项目决定）
- 单人项目：除“无人机足球任务”外的所有项目均为单人
- 3 人项目：无人机足球任务-3v3（200mm 空心杯 / 无刷）
- 5 人项目：无人机足球任务-5v5（400mm 无刷）

### 4.2 系统字段（自动生成）
- 报名状态：`待审核` / `已通过` / `已退回`
- 报名时间：系统时间
- 退回原因：管理员填写

---

## 5. 学生端流程（原子化步骤）

### 5.1 报名流程
1. 用户进入报名页面。
2. 系统检查是否已授权微信登录。
3. 若未授权：展示“微信授权登录”按钮。
4. 用户点击授权按钮。
5. 系统获取用户 OpenID 并保存。
6. 系统显示报名表单。
7. 用户选择“参赛项目（大类）”。
8. 系统联动加载“参赛项目（具体任务）”可选项。
9. 用户选择“参赛项目（具体任务）”。
10. 系统根据所选任务限制“参赛学段（组别）”可选范围。
11. 用户选择“参赛学段（组别）”。
12. 系统根据所选项目确定参赛人数（1/3/5）。
13. 系统动态展示对应数量的“选手姓名”输入框。
14. 用户依次填写所有必填字段。
15. 用户点击“提交报名”。
16. 系统校验字段完整性与格式（手机号、邮箱、必填）。
17. 校验通过：保存报名记录，状态=`待审核`。
18. 系统提示“报名已提交，等待审核”。
19. 校验失败：提示具体字段错误并停留在表单页面。

### 5.2 退回修改流程
1. 管理员退回报名并填写退回原因。
2. 系统通过通知渠道推送“退回”消息。
3. 学生端打开报名页面。
4. 系统显示退回原因。
5. 用户修改错误字段。
6. 用户再次提交。
7. 系统重新进入审核流程。

### 5.3 获奖查询流程
1. 用户点击“获奖查询”。
2. 输入参赛号。
3. 点击“查询”。
4. 系统根据参赛号匹配获奖数据。
5. 若匹配成功：展示奖状预览 + 下载按钮。
6. 若匹配失败：提示“很遗憾”。

### 5.4 优秀辅导员证书查询
1. 用户点击“优秀辅导员查询”。
2. 输入指导老师姓名与电话。
3. 点击“查询”。
4. 系统匹配优秀辅导员数据。
5. 匹配成功：展示证书预览 + 下载。
6. 匹配失败：提示“未查询到证书”。

---

## 6. 管理员端流程（原子化步骤）

### 6.1 登录
1. 管理员输入账号。
2. 输入密码。
3. 点击登录。
4. 系统校验账号密码。
5. 校验通过进入首页；失败提示“账号或密码错误”。

### 6.2 报名审核
1. 管理员进入“报名列表”。
2. 列表支持按学校/年级/首字母筛选。
3. 点击某条报名记录查看详情。
4. 点击“通过”或“退回”。
5. 若退回：输入退回原因（必填）。
6. 系统更新报名状态。
7. 系统发送通知给报名人。
8. 支持“导出报名数据”（按当前筛选条件导出 Excel）。

#### 6.2.1 可视化统计
1. 管理员进入“统计图表”页面。
2. 选择统计维度：学校名称 / 学生年龄。
3. 系统生成统计图表。
4. 图表类型支持：饼状图 / 柱状图。
5. 支持切换维度与图表类型并即时刷新。

### 6.3 参赛号导入与匹配
1. 管理员下载/获取参赛号 Excel 模板。
2. 按模板填写：选手姓名、学校、参赛号等字段。
3. 在后台点击“导入参赛号”。
4. 选择 Excel 文件上传。
5. 系统解析 Excel。
6. 系统逐行校验字段格式。
7. 校验失败：提示错误行与原因。
8. 校验成功：与报名数据匹配。

#### 6.3.3 名单比对与异常处理
1. 系统对比“报名库”与“导入参赛号库”。
2. 若姓名或学校不匹配，则将该行标记为“异常”。
3. 异常记录在列表中高亮显示。
4. 提供“导出异常人员名单”功能（Excel）。
5. 正常匹配记录更新参赛号字段。

### 6.4 获奖信息导入与证书生成
1. 管理员获取获奖 Excel 模板。
2. 填写：姓名、学校、获奖级别等字段。
3. 上传 Excel。
4. 系统解析并校验。
5. 校验成功后更新获奖数据库。
6. 系统读取证书底板素材（固定底板，不做内容修改）。
7. 系统仅填充动态字段（赛别/组别/姓名/获奖级别）生成奖状 PDF。
8. 支持批量生成与下载。
9. 多人项目：证书中展示全部队员姓名。

### 6.5 优秀辅导员导入与证书生成
1. 管理员获取优秀辅导员 Excel 模板。
2. 填写：指导老师姓名、电话、学校、奖项/级别等。
3. 上传 Excel。
4. 系统解析并校验。
5. 系统与报名阶段“指导老师信息”匹配。
6. 匹配成功写入优秀辅导员数据库。
7. 按模板批量生成证书 PDF。
8. 支持下载。

---

## 7. 证书模板规范（必须）

### 7.1 甲方需提供素材
- 证书背景 PNG（A4 或指定像素，已包含 Logo/盖章等固定元素）
- 字体文件（TTF/OTF）
> 证书不包含二维码。
> 证书底板已包含除“赛别/组别/姓名/获奖级别”以外的所有内容，底板不做修改。

### 7.2 动态字段渲染规则
- 每个字段有固定“文本框范围”（左上坐标+宽度）
- 文字在文本框内居中显示
- 文字过长：可自动缩小字号或换行

### 7.3 证书字段示例
- 学生证书：姓名、赛别、组别、获奖级别
- 优秀辅导员证书：姓名、赛别、获奖级别

---

## 8. Excel 模板字段

### 8.1 参赛号导入模板
- 参赛号（唯一，必填）
- 选手姓名（必填）
- 选手手机号（必填）

### 8.2 获奖导入模板
- 参赛号（优先匹配，必填）
- 选手姓名（必填）
- 学校名称（必填）
- 获奖级别（必填，如一等奖/二等奖等）
- 赛别/项目（必填）
- 组别/学段（必填）

### 8.3 优秀辅导员导入模板
- 指导老师姓名（必填）
- 指导老师电话（必填）

---

## 9. 通知与消息
- 报名退回后发送通知。
- 通知渠道：公众号通知或邮件（以最终配置为准）。

---

## 10. 权限与安全
- 管理员端需登录后访问。
- 数据库中手机号、邮箱等敏感信息需脱敏或加密存储。

---

## 11. 部署
- 部署在乙方服务器。

---

## 12. 交付物
- 学生端小程序
- 管理员端小程序
- 后端接口与数据库结构
- 证书生成服务
- 导入模板与说明文档

---

## 13. 验收标准（示例）
1. 报名必填字段缺失时无法提交。
2. 退回后可正确重新提交。
3. 参赛号导入后能匹配到报名记录。
4. 获奖导入后能批量生成 PDF。
5. 优秀辅导员导入后能查询证书。
6. 证书文字居中显示并可下载。
